#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "üá¶üá∫ Running pre-commit checks with Australian spelling..."

# Run type checking
echo "üìù Type checking..."
npm run type-check || {
  echo "‚ùå Type check failed. Fix TypeScript errors before committing."
  exit 1
}

# Run linting
echo "üîç Linting..."
npm run lint || {
  echo "‚ùå Linting failed. Fix lint errors before committing."
  exit 1
}

# Check for American spellings in new/modified files
echo "üî§ Checking spelling conventions..."
git diff --cached --name-only | grep -E '\.(ts|tsx|js|jsx)$' | while read file; do
  if grep -E 'organization[^s]|color|center[^e]|analyze' "$file" > /dev/null 2>&1; then
    echo "‚ö†Ô∏è  Warning: American spelling detected in $file"
    echo "   Please use Australian spelling: organisation, colour, centre, analyse"
  fi
done

echo "‚úÖ Pre-commit checks passed!"